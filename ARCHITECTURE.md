# System Architecture

## ğŸ—ï¸ High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          USER INTERFACE                              â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                     Gradio Web UI                             â”‚  â”‚
â”‚  â”‚  â€¢ Chat interface                                            â”‚  â”‚
â”‚  â”‚  â€¢ Trip parameters form                                       â”‚  â”‚
â”‚  â”‚  â€¢ Mode selection (Simple/CrewAI)                           â”‚  â”‚
â”‚  â”‚  â€¢ Booking confirmation                                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â”‚ HTTP/WebSocket
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ORCHESTRATION LAYER                             â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              crew_setup_new.py                               â”‚   â”‚
â”‚  â”‚                                                               â”‚   â”‚
â”‚  â”‚  def run_travel_crew(params, mode, use_crewai):             â”‚   â”‚
â”‚  â”‚      if use_crewai:                                          â”‚   â”‚
â”‚  â”‚          return run_travel_crew_ai(params)  # CrewAI        â”‚   â”‚
â”‚  â”‚      else:                                                    â”‚   â”‚
â”‚  â”‚          return run_simple_mode(params)     # Direct Tools  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                             â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                â”‚           â”‚                 â”‚
        â–¼                â–¼           â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   SIMPLE     â”‚  â”‚         CREWAI AGENT SYSTEM               â”‚
â”‚   MODE       â”‚  â”‚                                            â”‚
â”‚              â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  Direct      â”‚  â”‚  â”‚   Travel Planning Coordinator    â”‚    â”‚
â”‚  Tool        â”‚  â”‚  â”‚   â€¢ Search flights & hotels      â”‚    â”‚
â”‚  Calls       â”‚  â”‚  â”‚   â€¢ Analyze preferences          â”‚    â”‚
â”‚              â”‚  â”‚  â”‚   â€¢ Create packages              â”‚    â”‚
â”‚              â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚              â”‚  â”‚               â”‚                            â”‚
â”‚              â”‚  â”‚               â–¼                            â”‚
â”‚              â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚              â”‚  â”‚  â”‚   Policy Compliance Officer      â”‚    â”‚
â”‚              â”‚  â”‚  â”‚   â€¢ Validate against rules       â”‚    â”‚
â”‚              â”‚  â”‚  â”‚   â€¢ RAG-based policy search     â”‚    â”‚
â”‚              â”‚  â”‚  â”‚   â€¢ Flag violations              â”‚    â”‚
â”‚              â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚              â”‚  â”‚               â”‚                            â”‚
â”‚              â”‚  â”‚               â–¼                            â”‚
â”‚              â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚              â”‚  â”‚  â”‚   Destination Research Specialistâ”‚    â”‚
â”‚              â”‚  â”‚  â”‚   â€¢ Weather forecast             â”‚    â”‚
â”‚              â”‚  â”‚  â”‚   â€¢ Restaurant recommendations   â”‚    â”‚
â”‚              â”‚  â”‚  â”‚   â€¢ Travel warnings              â”‚    â”‚
â”‚              â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚              â”‚  â”‚               â”‚                            â”‚
â”‚              â”‚  â”‚               â–¼                            â”‚
â”‚              â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚              â”‚  â”‚  â”‚   Booking Specialist             â”‚    â”‚
â”‚              â”‚  â”‚  â”‚   â€¢ Execute reservations         â”‚    â”‚
â”‚              â”‚  â”‚  â”‚   â€¢ Generate confirmations       â”‚    â”‚
â”‚              â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚              â”‚  â”‚                                            â”‚
â”‚              â”‚  â”‚  Powered by: Ollama LLM (local)          â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                            â”‚
       â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚     â”‚
       â–¼     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           TOOLS LAYER                                â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   Travel     â”‚  â”‚   Policy     â”‚  â”‚    Trip      â”‚             â”‚
â”‚  â”‚   History    â”‚  â”‚   RAG        â”‚  â”‚   Research   â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚         â”‚                  â”‚                  â”‚                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   Web        â”‚  â”‚   Booking    â”‚  â”‚   Payment    â”‚             â”‚
â”‚  â”‚   Search     â”‚  â”‚   Workflow   â”‚  â”‚   Profile    â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                  â”‚                  â”‚
          â–¼                  â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          DATA LAYER                                  â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚   Travel    â”‚  â”‚   Travel    â”‚  â”‚   Company   â”‚                â”‚
â”‚  â”‚   History   â”‚  â”‚   Profile   â”‚  â”‚   Policy    â”‚                â”‚
â”‚  â”‚   (.xlsx)   â”‚  â”‚   (.json)   â”‚  â”‚   (.md)     â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚   Booking   â”‚  â”‚    Vector Store (FAISS)     â”‚                  â”‚
â”‚  â”‚   History   â”‚  â”‚    â€¢ Policy embeddings       â”‚                  â”‚
â”‚  â”‚   (.json)   â”‚  â”‚    â€¢ Semantic search         â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Request Flow

### Simple Mode Flow

```
1. User Input
   â†“
2. Orchestrator (crew_setup_new.py)
   â†“
3. Direct Tool Execution
   â”œâ”€â†’ Load Travel History
   â”œâ”€â†’ Analyze Preferences
   â”œâ”€â†’ Search Flights
   â”œâ”€â†’ Search Hotels
   â”œâ”€â†’ Check Policy (RAG)
   â””â”€â†’ Research Destination
   â†“
4. Rank & Format Results
   â†“
5. Return to UI
   
Time: < 3 seconds
```

### CrewAI Mode Flow

```
1. User Input
   â†“
2. Orchestrator (crew_setup_new.py)
   â†“
3. Initialize Agents + LLM (Ollama)
   â†“
4. Create Tasks
   â†“
5. Crew Execution (Sequential Process)
   â”‚
   â”œâ”€â†’ Task 1: Travel Planner
   â”‚   â€¢ Get traveler preferences (tool call)
   â”‚   â€¢ Search flights (tool call)
   â”‚   â€¢ Search hotels (tool call)
   â”‚   â€¢ LLM: Analyze and create packages
   â”‚   â†“
   â”œâ”€â†’ Task 2: Policy Officer
   â”‚   â€¢ Review packages
   â”‚   â€¢ Check policy compliance (tool call + RAG)
   â”‚   â€¢ LLM: Flag violations, suggest alternatives
   â”‚   â†“
   â”œâ”€â†’ Task 3: Research Specialist
   â”‚   â€¢ Research destination (tool call)
   â”‚   â€¢ LLM: Compile destination guide
   â”‚   â†“
   â””â”€â†’ Task 4: Travel Planner (Final)
       â€¢ LLM: Combine all info
       â€¢ LLM: Create final recommendation
   â†“
6. Return to UI

Time: 30-60 seconds (first), 5-15 seconds (subsequent)
```

## ğŸ—„ï¸ Data Flow

### Travel History Analysis

```
data/sample_travel_history.xlsx
            â†“
    [Load CSV/Excel]
            â†“
    [Parse Records]
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Trip Records              â”‚
â”‚ â€¢ Trip Code               â”‚
â”‚ â€¢ Origin/Destination      â”‚
â”‚ â€¢ Airline (preference)    â”‚
â”‚ â€¢ Hotel (preference)      â”‚
â”‚ â€¢ Flight Class            â”‚
â”‚ â€¢ Cost                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
    [Analyze Patterns]
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Preferences Extracted     â”‚
â”‚ â€¢ Preferred Airlines      â”‚
â”‚ â€¢ Preferred Hotels        â”‚
â”‚ â€¢ Typical Flight Class    â”‚
â”‚ â€¢ Average Cost            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
    [Rank Search Results]
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Personalized Rankings     â”‚
â”‚ â­ Delta (5/7 trips)      â”‚
â”‚    United (2/7 trips)     â”‚
â”‚ â­ Marriott (6/7 stays)   â”‚
â”‚    Hilton (1/7 stays)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Policy Compliance (RAG)

```
data/company_policy.md
            â†“
    [Load Document]
            â†“
    [Split into Chunks]
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Policy Chunks (~300 words)â”‚
â”‚ â€¢ Flight policy           â”‚
â”‚ â€¢ Hotel policy            â”‚
â”‚ â€¢ Approval rules          â”‚
â”‚ â€¢ Expense limits          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
[Sentence Transformers]
[Create Embeddings]
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Vector Store (FAISS)      â”‚
â”‚ â€¢ 384-dim vectors         â”‚
â”‚ â€¢ Fast similarity search  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”œâ”€â”€â†’ Query: "hotel rate NYC"
            â”‚         â†“
            â”‚    [Semantic Search]
            â”‚         â†“
            â””â”€â”€â†’ Top 3 Relevant Chunks:
                 1. "Tier 1 cities: $250/night max"
                 2. "Marriott preferred"
                 3. "Manager approval >$2500"
```

## ğŸ§© Component Interaction

### Agent â†’ Tool â†’ Data

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Agent           â”‚
â”‚  "Search for     â”‚ â”€â”€â”
â”‚   flights to NYC"â”‚   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                       â”‚ (tool call)
                       â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  Tool Function       â”‚
            â”‚  search_flights()    â”‚
            â”‚  â€¢ origin            â”‚ â”€â”€â”
            â”‚  â€¢ destination       â”‚   â”‚
            â”‚  â€¢ dates             â”‚   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                                       â”‚ (data access)
                                       â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  External Data      â”‚
                            â”‚  â€¢ Mock API         â”‚
                            â”‚  â€¢ Web Scraping     â”‚
                            â”‚  â€¢ Real API (future)â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â”‚ (results)
                                       â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  Formatted Results   â”‚
            â”‚  5 flight options    â”‚
            â”‚  with pricing        â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â”‚ (return)
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Agent           â”‚
â”‚  "Here are 5     â”‚
â”‚   flight options"â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” Security Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Security Layers                   â”‚
â”‚                                              â”‚
â”‚  Layer 1: Local-First                       â”‚
â”‚  â€¢ All processing local                     â”‚
â”‚  â€¢ No cloud API calls                       â”‚
â”‚  â€¢ Ollama runs localhost                    â”‚
â”‚                                              â”‚
â”‚  Layer 2: Data Protection                   â”‚
â”‚  â€¢ Travel history (local files)             â”‚
â”‚  â€¢ Payment info (encrypted/mock)            â”‚
â”‚  â€¢ No PII sent to LLM                       â”‚
â”‚                                              â”‚
â”‚  Layer 3: Access Control (Future)           â”‚
â”‚  â€¢ User authentication                      â”‚
â”‚  â€¢ Role-based access (RBAC)                 â”‚
â”‚  â€¢ Session management                       â”‚
â”‚                                              â”‚
â”‚  Layer 4: Audit & Monitoring (Future)       â”‚
â”‚  â€¢ All actions logged                       â”‚
â”‚  â€¢ Policy violations tracked                â”‚
â”‚  â€¢ Booking confirmations saved              â”‚
â”‚                                              â”‚
â”‚  Layer 5: Encryption (Future)               â”‚
â”‚  â€¢ Data at rest (Fernet/KMS)               â”‚
â”‚  â€¢ Data in transit (TLS)                    â”‚
â”‚  â€¢ Key rotation                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š Technology Stack

### Frontend
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Gradio       â”‚  â† Web UI framework
â”‚                 â”‚    â€¢ Python-based
â”‚    â€¢ Blocks     â”‚    â€¢ Reactive
â”‚    â€¢ Chatbot    â”‚    â€¢ WebSocket support
â”‚    â€¢ Forms      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Backend
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Python       â”‚  â† Core language
â”‚                 â”‚
â”‚    â€¢ CrewAI     â”‚  â† Agent framework
â”‚    â€¢ LangChain  â”‚  â† LLM orchestration
â”‚    â€¢ Pandas     â”‚  â† Data processing
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### AI/ML
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Ollama               â”‚  â† Local LLM runtime
â”‚    â€¢ llama3.2           â”‚
â”‚    â€¢ mistral            â”‚
â”‚    â€¢ phi3               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Sentence Transformers  â”‚  â† Embeddings
â”‚  â€¢ all-MiniLM-L6-v2     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       FAISS             â”‚  â† Vector DB
â”‚  â€¢ IndexFlatIP          â”‚
â”‚  â€¢ Fast similarity      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Data Storage
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   File-Based    â”‚  â† Current (demo)
â”‚                 â”‚
â”‚   â€¢ Excel/CSV   â”‚    Travel history
â”‚   â€¢ JSON        â”‚    Profiles, bookings
â”‚   â€¢ Markdown    â”‚    Policy docs
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Database      â”‚  â† Future (production)
â”‚                 â”‚
â”‚   â€¢ PostgreSQL  â”‚    Relational data
â”‚   â€¢ Redis       â”‚    Caching
â”‚   â€¢ S3/Blob     â”‚    Document storage
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Deployment Options

### Local Development (Current)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Developer Machine          â”‚
â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚   Ollama   â”‚  â”‚   Python   â”‚â”‚
â”‚  â”‚   :11434   â”‚  â”‚   :7860    â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                  â”‚
â”‚  Access: http://localhost:7860  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Corporate Deployment (Future)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Corporate Network                â”‚
â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚  â”‚  Load Balancer â”‚                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚           â”‚                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚    â”‚             â”‚                      â”‚
â”‚    â–¼             â–¼                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”                   â”‚
â”‚  â”‚App1â”‚       â”‚App2â”‚  â† Multiple       â”‚
â”‚  â””â”€â”€â”¬â”€â”˜       â””â”€â”€â”¬â”€â”˜     instances     â”‚
â”‚     â”‚            â”‚                      â”‚
â”‚     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚          â”‚                              â”‚
â”‚          â–¼                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚   PostgreSQL   â”‚  â† Shared DB       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚     Redis      â”‚  â† Cache           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚  Ollama Clusterâ”‚  â† LLM pool        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ Scalability Considerations

### Horizontal Scaling
```
Request â†’ Load Balancer
             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚        â”‚        â”‚
    â–¼        â–¼        â–¼
  [App1]  [App2]  [App3]
    â”‚        â”‚        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
      Shared Database
```

### Vertical Scaling
```
Simple Mode:
â€¢ CPU: 2 cores
â€¢ RAM: 2 GB
â€¢ Handles: 50+ concurrent users

CrewAI Mode:
â€¢ CPU: 8 cores (LLM inference)
â€¢ RAM: 8 GB (model in memory)
â€¢ GPU: Optional (2x faster)
â€¢ Handles: 10-20 concurrent users
```

## ğŸ“ˆ Performance Optimization

### Caching Strategy
```
Request: "Flights Chicago â†’ NYC"
         â†“
    [Check Cache]
         â†“
    Cache Hit? â”€â†’ Yes â†’ Return cached results (< 100ms)
         â”‚
         No
         â†“
    [Search APIs]
         â†“
    [Cache Results]  (TTL: 15 minutes)
         â†“
    [Return to User]  (2-3 seconds)
```

### Database Indexing
```sql
-- For fast lookups
CREATE INDEX idx_user_history 
  ON travel_history(user_id, trip_date);

CREATE INDEX idx_policy_search 
  ON policy_chunks USING GIN(content_vector);
```

## ğŸ” Monitoring & Observability

### Metrics to Track
```
Application Metrics:
â€¢ Request rate (req/sec)
â€¢ Response time (p50, p95, p99)
â€¢ Error rate (%)
â€¢ Active users

Agent Metrics:
â€¢ Task completion time
â€¢ Tool call latency
â€¢ LLM token usage
â€¢ Agent success rate

Business Metrics:
â€¢ Bookings completed
â€¢ Policy violations
â€¢ Average trip cost
â€¢ User satisfaction
```

## ğŸ Summary

**Architecture Type**: Modular, Event-Driven, Agent-Based

**Key Characteristics**:
- ğŸ¯ Separation of concerns (UI, Orchestration, Tools, Data)
- ğŸ”Œ Pluggable components (easy to swap tools/agents)
- ğŸ”’ Security-first design (local processing)
- ğŸ“ˆ Scalable (horizontal scaling ready)
- ğŸ§ª Testable (tools can be mocked)
- ğŸ“š Well-documented (inline + external docs)

**Production Readiness**: 70%
- âœ… Core architecture solid
- âœ… Agent framework working
- âœ… Tool system extensible
- âš ï¸ Needs real APIs
- âš ï¸ Needs authentication
- âš ï¸ Needs production database

---

**Next Steps**: See [SETUP_GUIDE.md](SETUP_GUIDE.md) for deployment instructions.

